c####&


        subroutine filltensor(cc,tensorname,handedness)

        implicit none

c Include constants:
        include 'params.h'
        integer i,j,k,l
        real cc(3,3,3,3)
        real c(6,6)
        real gpa2pa,mbar2pa,rhokgm
        character tensorname*(namelen),handedness*(namelen)

        do i=1,6
         do j=1,6
           c(i,j)=0.
         enddo
        enddo

c       1 Mbar = 100 GPa; internal tensor units are Pa/(kg/M^3)
        gpa2pa  =   1000000000.
        mbar2pa = 100000000000.

        open(unit=iounit3,file=tensorname,status='old')

        read(iounit3,*) rhokgm

        do i=1,6
            read(iounit3,*) c(i,1),c(i,2),c(i,3),c(i,4),c(i,5),c(i,6)
        enddo

        close(iounit3)

        do i=1,6
                do j=1,6
                        c(i,j)=c(i,j) * mbar2pa / rhokgm
                enddo  
        enddo
      
        if (handedness .eq. 'L') then
            call c2c4left(c,cc)
        else if (handedness .eq. 'R') then
            call c2c4(c,cc)
        else
            write(*,*) handedness, ' is not a valid handedness.'
            write(*,*) 'Must be R or L.'
            stop
        end if

        write(*,*) 'sample cijkl: c1111=',cc(1,1,1,1)

        end


        SUBROUTINE c2c4(c,cc)   
        REAL c(6,6),cc(3,3,3,3)
        INTEGER i,j,k,l 

            do i=1,3
                do j=1,3
                    do k=1,3
                        do l=1,3
                            cc(i,j,k,l)=0
                        end do
                    end do
                end do
            end do

        cc(1,1,1,1) = c(1,1)
        cc(2,2,2,2) = c(2,2)
        cc(3,3,3,3) = c(3,3)
        cc(2,3,2,3) = c(4,4)
        cc(3,2,3,2) =cc(2,3,2,3)
        cc(2,3,3,2) =cc(2,3,2,3)
        cc(3,2,2,3) =cc(2,3,2,3)
        cc(1,3,1,3) = c(5,5)
        cc(3,1,1,3) =cc(1,3,1,3)
        cc(1,3,3,1) =cc(1,3,1,3)
        cc(3,1,3,1) =cc(1,3,1,3)
        cc(1,1,2,2) = c(1,2)
        cc(2,2,1,1) =cc(1,1,2,2)
        cc(1,1,3,3) = c(1,3)
        cc(3,3,1,1) =cc(1,1,3,3)
        cc(1,1,2,3) = c(1,4)
        cc(1,1,3,2) =cc(1,1,2,3)
        cc(2,3,1,1) =cc(1,1,2,3)
        cc(3,2,1,1) =cc(1,1,2,3)
        cc(1,1,1,3) = c(1,5)
        cc(1,1,3,1) =cc(1,1,1,3)
        cc(1,3,1,1) =cc(1,1,1,3)
        cc(3,1,1,1) =cc(1,1,1,3)
        cc(1,1,1,2) = c(1,6)
        cc(1,1,2,1) =cc(1,1,1,2)
        cc(1,2,1,1) =cc(1,1,1,2)
        cc(2,1,1,1) =cc(1,1,1,2)
        cc(2,2,3,3) = c(2,3)
        cc(3,3,2,2) =cc(2,2,3,3)
        cc(2,2,2,3) = c(2,4)
        cc(2,2,3,2) =cc(2,2,2,3)
        cc(2,3,2,2) =cc(2,2,2,3)
        cc(3,2,2,2) =cc(2,2,2,3)
        cc(2,2,1,3) = c(2,5)
        cc(2,2,3,1) =cc(2,2,1,3)
        cc(1,3,2,2) =cc(2,2,1,3)
        cc(3,1,2,2) =cc(2,2,1,3)
        cc(2,2,1,2) = c(2,6)
        cc(2,2,2,1) =cc(2,2,1,2)
        cc(1,2,2,2) =cc(2,2,1,2)
        cc(2,1,2,2) =cc(2,2,1,2)
        cc(3,3,2,3) = c(3,4)
        cc(3,3,3,2) = cc(3,3,2,3)
        cc(2,3,3,3) = cc(3,3,2,3)
        cc(3,2,3,3) = cc(3,3,2,3)
        cc(3,3,1,3) = c(3,5)
        cc(3,3,3,1) = cc(3,3,1,3)
        cc(1,3,3,3) = cc(3,3,1,3)
        cc(3,1,3,3) = cc(3,3,1,3)
        cc(3,3,1,2) = c(3,6)
        cc(3,3,2,1) = cc(3,3,1,2)
        cc(1,2,3,3) = cc(3,3,1,2)
        cc(2,1,3,3) = cc(3,3,1,2)
        cc(2,3,1,3) = c(4,5)
        cc(3,2,1,3) =cc(2,3,1,3)
        cc(1,3,3,2) =cc(2,3,1,3)
        cc(1,3,2,3) =cc(2,3,1,3)
        cc(2,3,3,1) =cc(2,3,1,3)
        cc(3,2,3,1) =cc(2,3,1,3)
        cc(3,1,2,3) =cc(2,3,1,3)
        cc(3,1,3,2) =cc(2,3,1,3)
        cc(2,3,1,2) = c(4,6)
        cc(3,2,1,2) =cc(2,3,1,2)
        cc(1,2,2,3) =cc(2,3,1,2)
        cc(1,2,3,2) =cc(2,3,1,2)
        cc(2,3,2,1) =cc(2,3,1,2)
        cc(3,2,2,1) =cc(2,3,1,2)
        cc(2,1,2,3) =cc(2,3,1,2)
        cc(2,1,3,2) =cc(2,3,1,2)
        cc(1,3,1,2) = c(5,6)
        cc(3,1,1,2) =cc(1,3,1,2)
        cc(1,2,1,3) =cc(1,3,1,2)
        cc(1,2,3,1) =cc(1,3,1,2)
        cc(1,3,2,1) =cc(1,3,1,2)
        cc(3,1,2,1) =cc(1,3,1,2)
        cc(2,1,1,3) =cc(1,3,1,2)
        cc(2,1,3,1) =cc(1,3,1,2)
        cc(1,2,1,2) = c(6,6)
        cc(2,1,1,2) =cc(1,2,1,2)
        cc(1,2,2,1) =cc(1,2,1,2)
        cc(2,1,2,1) =cc(1,2,1,2)

        
        end

        SUBROUTINE c2c4left(c,cc)   
        REAL c(6,6),cc(3,3,3,3)
        INTEGER i,j,k,l 

            do i=1,3
                do j=1,3
                    do k=1,3
                        do l=1,3
                            cc(i,j,k,l)=0
                        end do
                    end do
                end do
            end do

        cc(3,3,3,3) = c(1,1)
        cc(2,2,2,2) = c(2,2)
        cc(1,1,1,1) = c(3,3)
        cc(2,1,2,1) = c(4,4)
        cc(1,2,1,2) =cc(2,1,2,1)
        cc(2,1,1,2) =cc(2,1,2,1)
        cc(1,2,2,1) =cc(2,1,2,1)
        cc(3,1,3,1) = c(5,5)
        cc(1,3,3,1) =cc(3,1,3,1)
        cc(3,1,1,3) =cc(3,1,3,1)
        cc(1,3,1,3) =cc(3,1,3,1)
        cc(3,3,2,2) = c(3,2)
        cc(2,2,3,3) =cc(3,3,2,2)
        cc(3,3,1,1) = c(3,1)
        cc(1,1,3,3) =cc(3,3,1,1)
        cc(3,3,2,1) = c(3,4)
        cc(3,3,1,2) =cc(3,3,2,1)
        cc(2,1,3,3) =cc(3,3,2,1)
        cc(1,2,3,3) =cc(3,3,2,1)
        cc(3,3,3,1) = c(3,5)
        cc(3,3,1,3) =cc(3,3,3,1)
        cc(3,1,3,3) =cc(3,3,3,1)
        cc(1,3,3,3) =cc(3,3,3,1)
        cc(3,3,3,2) = c(3,6)
        cc(3,3,2,3) =cc(3,3,3,2)
        cc(3,2,3,3) =cc(3,3,3,2)
        cc(2,3,3,3) =cc(3,3,3,2)
        cc(2,2,1,1) = c(2,1)
        cc(1,1,2,2) =cc(2,2,1,1)
        cc(2,2,2,1) = c(2,4)
        cc(2,2,1,2) =cc(2,2,2,1)
        cc(2,1,2,2) =cc(2,2,2,1)
        cc(1,2,2,2) =cc(2,2,2,1)
        cc(2,2,3,1) = c(2,5)
        cc(2,2,1,3) =cc(2,2,3,1)
        cc(3,1,2,2) =cc(2,2,3,1)
        cc(1,3,2,2) =cc(2,2,3,1)
        cc(2,2,3,2) = c(2,6)
        cc(2,2,2,3) =cc(2,2,3,2)
        cc(3,2,2,2) =cc(2,2,3,2)
        cc(2,3,2,2) =cc(2,2,3,2)
        cc(1,1,2,1) = c(3,4)
        cc(1,1,1,2) = cc(1,1,2,1)
        cc(2,1,1,1) = cc(1,1,2,1)
        cc(1,2,1,1) = cc(1,1,2,1)
        cc(1,1,3,1) = c(3,5)
        cc(1,1,1,3) = cc(1,1,3,1)
        cc(3,1,1,1) = cc(1,1,3,1)
        cc(1,3,1,1) = cc(1,1,3,1)
        cc(1,1,3,2) = c(3,6)
        cc(1,1,2,3) = cc(1,1,3,2)
        cc(3,2,1,1) = cc(1,1,3,2)
        cc(2,3,1,1) = cc(1,1,3,2)
        cc(2,1,3,1) = c(4,5)
        cc(1,2,3,1) =cc(2,1,3,1)
        cc(3,1,1,2) =cc(2,1,3,1)
        cc(3,1,2,1) =cc(2,1,3,1)
        cc(2,1,1,3) =cc(2,1,3,1)
        cc(1,2,1,3) =cc(2,1,3,1)
        cc(1,3,2,1) =cc(2,1,3,1)
        cc(1,3,1,2) =cc(2,1,3,1)
        cc(2,1,3,2) = c(4,6)
        cc(1,2,3,2) =cc(2,1,3,2)
        cc(3,2,2,1) =cc(2,1,3,2)
        cc(3,2,1,2) =cc(2,1,3,2)
        cc(2,1,2,3) =cc(2,1,3,2)
        cc(1,2,2,3) =cc(2,1,3,2)
        cc(2,3,2,1) =cc(2,1,3,2)
        cc(2,3,1,2) =cc(2,1,3,2)
        cc(3,1,3,2) = c(5,6)
        cc(1,3,3,2) =cc(3,1,3,2)
        cc(3,2,3,1) =cc(3,1,3,2)
        cc(3,2,1,3) =cc(3,1,3,2)
        cc(3,1,2,3) =cc(3,1,3,2)
        cc(3,1,2,3) =cc(3,1,3,2)
        cc(2,3,3,1) =cc(3,1,3,2)
        cc(2,3,1,3) =cc(3,1,3,2)
        cc(3,2,3,2) = c(6,6)
        cc(2,3,3,2) =cc(3,2,3,2)
        cc(3,2,2,3) =cc(3,2,3,2)
        cc(2,3,2,3) =cc(3,2,3,2)

	
        end